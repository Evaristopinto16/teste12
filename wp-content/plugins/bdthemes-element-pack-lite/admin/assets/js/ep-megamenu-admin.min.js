!function(e){const n={body:e("body"),element:document.getElementById("menu-to-edit"),settingModal:e("#bdt-ep-megamenu-modal"),init(){this.initBodyEvent(),this.initPlugins(),this.megaMenuSettingEvent(),this.onSaveSettings(),this.openElementorEditor(),this.closeElementorEditor()},megaMenuModal:(n="")=>e("#bdt-ep-megamenu-modal "+n),elementorEditor:(n="")=>e("#ep-megamenu-content "+n),elementorEditorConfirmation:(n="")=>e("#ep-megamenu-editor-confirmation "+n),initPlugins(){n.megaMenuModal(".ep-menu-colorpicker").wpColorPicker(),AestheticIconPicker({selector:"#icon-picker-wrap",onClick:"#select-icon"})},megaMenuSettingEvent(){n.element.addEventListener("cardupdate",(function(n){n.detail.isEnabled?e("#menu-item-"+n.detail.menuID).addClass("ep-megamenu-active"):e("#menu-item-"+n.detail.menuID).removeClass("ep-megamenu-active")})),e.each(megaMenuBuilder.items,(function(n,a){e(a).length&&e(a).addClass("ep-megamenu-active")})),n.megaMenuModal("#bdt-item-enable").on("change",(function(){e(this).is(":checked")?(n.megaMenuModal("#ep-content-trigger").prop("disabled",!1),n.megaMenuModal("#ep-megamenu-toggler").addClass("ep_megamenu_enabled")):(n.megaMenuModal("#ep-megamenu-toggler").removeClass("ep_megamenu_enabled"),n.megaMenuModal("#ep-content-trigger").prop("disabled",!0))})),n.megaMenuModal("#ep-content-width-type").on("change",(function(){"custom_width"===this.value?n.megaMenuModal("#ep-megamenu-custom-content").show():n.megaMenuModal("#ep-megamenu-custom-content").hide()}))},onSaveSettings(){n.megaMenuModal(".ep-item-save").on("click",(function(){var a=e(this).parent().find(".spinner"),t={action:"ep_save_menu_item_settings",settings:{menu_id:n.megaMenuModal("#ep-modal-menu-id").val(),menu_has_child:n.megaMenuModal("#ep-has-child").val(),menu_enable:n.megaMenuModal("#bdt-item-enable:checked").val(),menu_trigger_effect:n.megaMenuModal("#mega-menu-trigger-effect").val(),menu_mobile_content_type:n.megaMenuModal("#mobile_submenu_content_type").val(),menu_width_type:n.megaMenuModal("#ep-content-width-type").val(),custom_menu_position:n.megaMenuModal("#ep-megamenu-custom-position-value").val(),menu_badge_label:n.megaMenuModal("#ep-badge-text-field").val(),menu_custom_width:n.megaMenuModal("#ep-custom-width-value").val(),megamenu_badge_color:n.megaMenuModal("#ep-badge-text-color").val(),menu_badge_bgcolor:n.megaMenuModal("#ep-badge-text-bgcolor").val(),megamenu_icon:n.megaMenuModal("#icon_value").val(),megamenu_icon_library:n.megaMenuModal("#icon_library").val(),megamenu_icon_color:n.megaMenuModal("#ep-icon-color").val()},nocache:Math.floor(Date.now()/1e3)};a.addClass("loading"),e.ajax({url:ajaxurl,type:"post",data:t,success:function(e){n.megaMenuModal(".ep-save-notice").fadeIn("slow"),n.megaMenuModal(".ep-save-notice").html(e.message),setTimeout((function(){n.megaMenuModal(".ep-save-notice").fadeOut("slow")}),1500),a.removeClass("loading")}}),t={menuID:e("#ep-modal-menu-id").val(),isEnabled:e("#bdt-item-enable:checked").val()},n.element.dispatchEvent(new CustomEvent("cardupdate",{detail:t}))}))},openElementorEditor(){n.megaMenuModal("#ep-content-trigger").on("click",(function(){var a,t=n.megaMenuModal("#ep-modal-menu-id").val();e.ajax({url:ajaxurl,type:"post",data:{action:"ep_get_content_editor",key:t},success:function(e){a=e,n.elementorEditor("#ep-megamenu-iframe").empty(),n.elementorEditor("#ep-megamenu-iframe").attr("src",a),bdtUIkit.modal(n.elementorEditor()).show()}})}))},closeElementorEditor(){n.elementorEditor(".close-mega-menu-modal").on("click",(function(e){e.preventDefault();const a=document.getElementById("ep-megamenu-iframe"),t=a.contentWindow||a.contentDocument;t.jQuery("#elementor-panel-saver-button-publish").hasClass("elementor-disabled")?setTimeout((function(){t.jQuery(t).off("beforeunload"),bdtUIkit.modal(n.elementorEditorConfirmation(),{stack:!0}).hide(),bdtUIkit.modal(n.elementorEditor()).hide()}),400):bdtUIkit.modal(n.elementorEditorConfirmation(),{stack:!0}).show()})),n.elementorEditorConfirmation(".confirmation-ok").on("click",(function(e){e.preventDefault();const a=document.getElementById("ep-megamenu-iframe"),t=a.contentWindow||a.contentDocument;t.jQuery("#elementor-panel-saver-button-publish").trigger("click"),setTimeout((function(){t.jQuery(t).off("beforeunload"),bdtUIkit.modal(n.elementorEditorConfirmation(),{stack:!0}).hide(),bdtUIkit.modal(n.elementorEditor()).hide()}),1e3)})),n.elementorEditorConfirmation(".confirmation-cancel").on("click",(function(e){e.preventDefault();const a=document.getElementById("ep-megamenu-iframe"),t=a.contentWindow||a.contentDocument;setTimeout((function(){t.jQuery(t).off("beforeunload"),bdtUIkit.modal(n.elementorEditorConfirmation(),{stack:!0}).hide(),bdtUIkit.modal(n.elementorEditor()).hide()}),400)}))},initBodyEvent(){n.body.on("DOMSubtreeModified","#nav-menu-header",(function(){setTimeout((function(){e("#ep-is-metabox-enabled").is(":checked")?n.body.removeClass("ep_megamenu_disabled").addClass("ep_megamenu_enabled"):n.body.removeClass("ep_megamenu_enabled").addClass("ep_megamenu_disabled")}),200)})),n.body.on("DOMSubtreeModified","#menu-to-edit",(function(){e("#menu-to-edit li.menu-item").each((function(){var n=e(this);n.find(".ep-menu-trigger-btn").length<1&&e(".item-title",n).append('<a id="bdthemes-element-pack-trigger-btn" class="ep-menu-trigger-btn" href="#bdt-ep-megamenu-modal"><span class="ep-megeamenu">Mega Menu</span><span class="ep-megeamenu-edit">Edit Mega Menu</span></a>')}))})),e("#nav-menu-header").on("change.ekit","#ep-is-metabox-enabled",(function(){e(this).is(":checked")?n.body.addClass("ep_megamenu_enabled").removeClass("ep_megamenu_disabled"):n.body.removeClass("ep_megamenu_enabled").addClass("ep_megamenu_disabled")})),e(window.ep_mega_menu_trigger_button).insertAfter("#nav-menu-header #menu-name").parent().find("#ep-megamenu-switcher").trigger("change.ekit"),e("#menu-to-edit").trigger("DOMSubtreeModified"),e("#menu-to-edit").on("click",".ep-menu-trigger-btn",(function(a){var t;return a.preventDefault(),a=e(this).parents("li.menu-item"),menu_id=parseInt(a.attr("id").match(/[0-9]+/)[0],10),a.find(".menu-item-title").text(),a.attr("class").match(/\menu-item-depth-(\d+)\b/)[1],e(".ep_menu_control_nav > li").removeClass("attr-active"),e(".attr-tab-pane").removeClass("attr-active"),e(this).parents(".menu-item").hasClass("menu-item-depth-0")?(t=0,n.settingModal.removeClass("ep-menu-has-child"),e("#attr_content_nav").addClass("attr-active"),e("#attr_content_tab").addClass("attr-active")):(t=1,n.settingModal.addClass("ep-menu-has-child"),e("#attr_icon_nav").addClass("attr-active"),e("#attr_icon_tab").addClass("attr-active")),e("#ep-modal-menu-id").val(menu_id),e("#ep-has-child").val(t),a={action:"ep_get_menu_item_settings",menu_id:menu_id,menu_width_type:n.megaMenuModal("#ep-content-width-type").val(),custom_menu_position:n.megaMenuModal("#ep-megamenu-custom-position-value").val(),menu_badge_label:n.megaMenuModal("#ep-badge-text-field").val(),menu_custom_width:n.megaMenuModal("#ep-custom-width-value").val(),megamenu_badge_color:n.megaMenuModal("#ep-badge-text-color").val(),menu_badge_bgcolor:n.megaMenuModal("#ep-badge-text-bgcolor").val(),megamenu_icon:n.megaMenuModal("#icon_value").val(),megamenu_icon_library:n.megaMenuModal("#icon_library").val(),megamenu_icon_color:n.megaMenuModal("#ep-icon-color").val(),nocache:Math.floor(Date.now()/1e3)},e.ajax({url:ajaxurl,type:"POST",data:a,dataType:"json",success:function(e){n.megaMenuModal("#ep-badge-text-field").val(e.menu_badge_label),n.megaMenuModal("#ep-custom-width-value").val(e.menu_custom_width),n.megaMenuModal("#ep-badge-text-color").val(e.megamenu_badge_color),n.megaMenuModal("#ep-badge-text-bgcolor").val(e.menu_badge_bgcolor),n.megaMenuModal("#icon_value").val(e.megamenu_icon),n.megaMenuModal("#icon_library").val(e.megamenu_icon_library),n.megaMenuModal("#ep-icon-color").val(e.megamenu_icon_color),n.megaMenuModal("#mega-menu-trigger-effect").val(e.menu_trigger_effect),n.megaMenuModal("#mobile_submenu_content_type").val(e.menu_mobile_content_type),void 0===e.menu_width_type?n.megaMenuModal("#ep-content-width-type").val("default_width").change():n.megaMenuModal("#ep-content-width-type").val(e.menu_width_type).change(),void 0===e.custom_menu_position?n.megaMenuModal("#ep-megamenu-custom-position-value").val("bottom-left").change():n.megaMenuModal("#ep-megamenu-custom-position-value").val(e.custom_menu_position).change(),n.megaMenuModal("#bdt-item-enable").prop("checked",!1),void 0!==typeof e.menu_enable&&1==e.menu_enable?n.megaMenuModal("#bdt-item-enable").prop("checked",!0):n.megaMenuModal("#bdt-item-enable").prop("checked",!1),n.megaMenuModal("#bdt-item-enable").trigger("change")}}),bdtUIkit.modal(n.settingModal).show(),!1}))}};n.init()}(jQuery,bdtUIkit);